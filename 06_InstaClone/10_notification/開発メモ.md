# 課題
- 通知機能を実装する。
- タイミングと文言は以下の通りとします。（リンク）と書いてある箇所はリンクを付与してください。
  - フォローされたとき
    - xxx（リンク）があなたをフォローしました
    - 通知そのものに対してはxxxへのリンクを張る
  - 自分の投稿にいいねがあったとき
    - xxx（リンク）があなたの投稿（リンク）にいいねしました
    - 通知そのものに対しては投稿へのリンクを張る
  - 自分の投稿にコメントがあったとき
    - xxx（リンク）があなたの投稿（リンク）にコメント（リンク）しました
    - 通知そのものに対してはコメントへのリンクを張る（厳密には投稿ページに遷移し当該コメント部分にページ内ジャンプするイメージ）
- 既読判定も行ってください。通知一覧において、既読のものは薄暗い背景で、未読のものは白い背景で表示しましょう。
- 既読とするタイミングは各通知そのものをクリックした時とします。
- 不自然ではありますが通知の元となったリソースが削除された際には通知自体も削除する仕様とします。

## 補足
- ポリモーフィック関連を使うこと
- ヘッダー部分の通知リストには最新の10件しか表示させないこと

# 開発メモ
## letter_opener_webの導入
### lettter_opener_web とは
- 送信したメールをブラウザ上で確認できる。
- 同様のサービスにletter_openerというものがあるが、これはリモート環境で使用することができない。
- letter_opener_webはリモート接続でも使用することが可能。
### 導入
```rb
# 2.0以上はRuby３が必要とのこと
gem 'letter_opener_web'
```
route.rbに記載
```rb
Rails.application.routes.draw do
  mount LetterOpenerWeb::Engine, at: "/letter_opener" if Rails.env.development?
end
```
この時点で、`http://localhost:3000/letter_opener` にアクセスすると、メールの一覧画面を表示できるようになる。
![Image from Gyazo](https://i.gyazo.com/60216106710fb26338623efa95fc5f13.png)

### 参考
[letter_opener_web](https://github.com/fgrehm/letter_opener_web)
[gem letter_opener を試してみる](https://qiita.com/tanutanu/items/c6193c4c2c352ac152絵c)

## Activityモデルを作る
```
rails g model Activity subject:references user:references action_type:integer read:boolean
```
```rb
class CreateActivities < ActiveRecord::Migration[5.2]
  def change
    create_table :activities do |t|
      # ポリモーフィック
      t.references :subject, polymorphic: true
      t.references :user, foreign_key: true
      t.integer :action_type, null: false
      t.boolean :read, null: false, default: false

      t.timestamps
    end
  end
end
```
### ポリモーフィックについて
#### ポリモーフィックとは
- ポリモーフィックなbelong_toは、他のあらゆるモデルから利用可能なインターフェースを設定する宣言とみなすことができる。

#### 従属する（利用される）モデルに記述する。
```rb
class Activity < ApplicationRecord
  belongs_to :subject, polymorphic: true
end
```

#### 従属される（利用する）モデルに記述する。
- 教科書通りでは、以下の通り記述する。
```rb
class Comment < ApplicationRecord
  has_many :activities, as: :sucject
end

class Like < ApplicationRecord
  has_many :activities, as: :sucject
end
```
上記の通り設定すると、activityのコレクションを、 commentやlikeのインスタンスから取得できる。
```
@comment.activities
@like.activities
```
- Activityのインスタンスがあれば、`Actibity.subject`と記述することで、親のインスタンスを取得できる。そのためには、ポリモーフィックなインターフェースを使うモデル（ここでは従属する側のモデル）にて、外部キーのカラムと型のカラムを両方とも設定する必要がある。

### enum



### 参考
[2.9 ポリモーフィック関連付け - Railsガイド](https://railsguides.jp/association_basics.html#%E3%83%9D%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%95%E3%82%A3%E3%83%83%E3%82%AF%E9%96%A2%E9%80%A3%E4%BB%98%E3%81%91)

## 通知の表示領域のビューを作る。

