# 質問機能の実装
## フォームを作成する
```tsx
<div className="row justify-content-center mb-3">
  <div className="col-12 col-md-6">
    <form>
      <textarea
        className="form-control"
        placeholder="おげんきですか？"
        rows={6}
        required
      ></textarea>
      <div className="m-3">
        <button type="submit" className="btn btn-primary">
          質問を送信する
        </button>
      </div>
    </form>
  </div>
</div>
```

## 質問の投稿機能
### 入力内容をステートに保存する
- まずは`<textarea>`の内容をステートに保存するようにする。
- `pages/users/[uid].tsx`に以下を貴受する巣。
  - まず、ステートを宣言する。
  - 現在ログインしているユーザーを取得する。
```tsx
import { useAuthentication } from '../hooks/authentication'

// 省略

export default function UserShow() {
  // 下記を追記
  const { user: currentUser } = useAuthentication()
  //const [状態変数, 状態を変更するための関数] = useState(状態の初期値);
  const [body, setBody] = useState('')

  // 省略

  return (
    <Layout>
      <div className="row justify-content-center mb-3">
        <div className="col-12 col-md-6">
          <form>
            // ここを編集
            <textarea
              className="form-control"
              placeholder="おげんきですか？"
              rows={6}
              // 入力されたvalueを変数valueに代入するということ？
              value={body}
              // イベントが発生したら、`e.target.value`をsetBodyするする。引数`e`はイベントを示す。
              onChange={(e) => setBody(e.target.value)}
              // `required`で入力必須とする
              required
            ></textarea>
            <div className="m-3">
              <button type="submit" className="btn btn-primary">
                質問を送信する
              </button>
            </div>
          </form>
        </div>
      </div>
    </Layout>
  )
}
```
> [React hooksを基礎から理解する (useState編)- Qiita](https://qiita.com/seira/items/f063e262b1d57d7e78b4)

### 送信処理
- 作成したステートを使い、送信処理を実装する。
- 送信用の関数を実装するため、イベント用の型(多分これはReact)やFirestoreへの保存用メソッドをインポートする。
- ドキュメントに有効なIDがない場合は`addDoc`メソッドをインポートする。
```tsx
import { FormEvent, useEffect, useState } from 'react'  // FormEventを追加
import {
  addDoc, // 今回追加
  collection,
  doc,
  getDoc,
  getFirestore,
  serverTimestamp,  // 今回追加
} from 'firebase/firestore'
```
> [List of event types - React TypeScript Cheatsheet](https://react-typescript-cheatsheet.netlify.app/docs/basic/getting-started/forms_and_events/#:~:text=List-,of,-event%20types%23)
> [ドキュメントの追加 - Firebase](https://firebase.google.com/docs/firestore/manage-data/add-data#:~:text=set_custom_object.js-,%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88,-%E3%81%AE%E8%BF%BD%E5%8A%A0)

- userShowの中に送信用の関数を定義する。
  - 
  - ドキュメントに有効なIDがない場合は`addDoc`メソッドをインポートする。
```tsx
async function onSubmit(e: FormEvent<HTMLFormElement>) {
  // あとで調べる
  e...()

  const db = getFirestore()

  // 非同期処理のaddDocを宣言する。引数は送信先のコレクション？
  await addDoc(collection(db, 'questions'), {
    // 送信者の情報は、senderUidにcurrentuserのuidを代入、receiverUidも同様
    senderUid: currentUser.uid,
    receiverUid: user.uid,
    // ここのbodyがそのままなのがよくわからない
    body,
    // 回答したかどうかのフラグ。デフォルトではfalseとする
    isReplied: false,
    // 作成日時は`serverTimestamp`で取得する。Firestoreのメソッド？後で調べる
    createdAt: serverTimestamp(),
  })

  // 送信が完了すると、フォームを空にし、メッセージ「質問を送信しました。」を表示する
  setBody('')
  alert('質問を送信しました。')
}
```
- formタグのonSubmitに `onSubmit`メソッドを追加する？解釈があってるか微妙。でもこれがメソッドと連携している。
```tsx
<form onSubmit={onSubmit}>
```

## ボタンの誤連打を防止
- 

## 完了メッセージを実装